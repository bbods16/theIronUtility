# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [0.1.0] - 2023-10-27

### Added
- Initial project scaffolding and repository structure.
- `pyproject.toml` for project metadata and dependency management.
- `README.md` with setup and development instructions.
- `LICENSE` file (Apache-2.0).
- `.pre-commit-config.yaml` for code quality hooks (ruff, black, isort, mypy).
- `DATA_CARD.md`, `MODEL_CARD.md`, `EVALUATION.md` for governance documentation.
- Initial Hydra configuration for data, model, train, eval, export.
- Basic CI workflow (`.github/workflows/ci.yml`) with linting, type-checking, and unit tests.
- DVC setup (`dvc.yaml`) for data versioning.
- `src/data/components.py` for `KeypointProcessor` (normalization, augmentation).
- `src/data/datasets.py` for `SquatFormDataset` and `SquatFormDatamodule` (data loading, subject-stratified splitting, class weighting).
- `src/models/form_classifier.py` for `TemporalConvolutionalNetwork` model.
- `src/train/trainer.py` for `SquatFormTrainer` (PyTorch Lightning module).
- `scripts/prepare_data.py` for simulated data generation, processing, and split file creation.
- `scripts/train.py` for orchestrating model training with Hydra and MLflow.
- `scripts/evaluate.py` for comprehensive model evaluation, sliced metrics, and HTML report generation.
- `scripts/export.py` for exporting models to ONNX format.
- `docs/DEPENDENCIES.md` for documenting project dependencies.
- `docs/DO_NOT_MODIFY.json` for method immutability guard.
- `docs/METHOD_OVERRIDES.md` for documenting method overrides.
- `resource_Examples/` directory with client-side web application files (`index.html`, `style.css`, `UIManager.js`, `media.js`, `ai-core.js`, `formChecker.js`).
- `formChecker.js` placeholder for client-side ML model integration.

### Changed
- Updated `src/data/datasets.py` to align `label_map` with client-side `ERROR_LABELS` (e.g., `knees_caving` to `KNEE_VALGUS`).
- Updated `data/processed/squat_form/labels.csv` and `scripts/prepare_data.py` to reflect the new label.
- Refined `scripts/prepare_data.py` to simulate raw keypoint data, process it with `KeypointProcessor`, generate `subject_metadata.csv`, and save subject-stratified splits to files.
- Updated `dvc.yaml` to track `data/processed/squat_form/subject_metadata.csv` and `data/splits/`.
- Modified `src/data/datasets.py` to load subject splits from files generated by `prepare_data.py`.
- Updated `src/train/trainer.py` to store predictions and labels during testing for detailed evaluation.
- Updated `configs/config.yaml` to include `project_name` and `run_name` for MLflow tracking, and explicitly set `_target_` for the Hydra Optuna sweeper.
- Updated `scripts/train.py` to integrate `accumulate_grad_batches` and properly configure DDP.
- Added `optuna` and `hydra-optuna-sweeper` to `pyproject.toml` and `requirements.txt` for hyperparameter optimization.

### Removed
- Old dummy data generation logic from `scripts/prepare_data.py`.

### Fixed
- Corrected `KeypointProcessor` configuration access in `src/data/components.py`.
- Resolved path separator and OmegaConf access issues in `tests/unit/test_data_datasets.py`.
- Fixed `AttributeError` in `test_squat_form_datamodule_setup` and `test_squat_form_datamodule_dataloaders` by correctly mocking `SquatFormDataset` instances.
